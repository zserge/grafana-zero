"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4253],{"./public/app/features/datasources/NewDataSourcePage.tsx":(e,a,s)=>{s.r(a),s.d(a,{default:()=>L,getNavModel:()=>N});var r=s("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),t=s("./.yarn/__virtual__/react-redux-virtual-8e30c710ae/0/cache/react-redux-npm-7.2.5-cf7e365145-04ac4a4178.zip/node_modules/react-redux/es/index.js"),n=s("./packages/grafana-ui/src/index.ts"),i=s("./packages/grafana-e2e-selectors/src/index.ts"),o=s("./public/app/core/components/Page/Page.tsx"),l=s("./public/app/features/datasources/state/actions.ts"),c=s("./public/app/features/datasources/state/selectors.ts"),u=s("./public/app/features/datasources/state/reducers.ts"),d=s("./.yarn/__virtual__/@emotion-css-virtual-9fd25d72e0/0/cache/@emotion-css-npm-11.1.3-72aa05c30f-dc50283f65.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),p=s("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/jsx-runtime.js");const g=e=>{let{logoUrl:a,logoAlt:s,title:r,description:t,labels:n,actions:i,onClick:o,ariaLabel:l,className:c}=e;const u=(0,d.cx)("add-data-source-item",c);return(0,p.jsxs)("div",{className:u,onClick:o,"aria-label":l,children:[a&&(0,p.jsx)("img",{className:"add-data-source-item-logo",src:a,alt:null!=s?s:""}),(0,p.jsxs)("div",{className:"add-data-source-item-text-wrapper",children:[(0,p.jsx)("span",{className:"add-data-source-item-text",children:r}),t&&(0,p.jsx)("span",{className:"add-data-source-item-desc",children:t}),n&&(0,p.jsx)("div",{className:"add-data-source-item-badge",children:n})]}),i&&(0,p.jsx)("div",{className:"add-data-source-item-actions",children:i})]})};var m,h,f,x,y,S=s("./public/app/features/plugins/admin/state/hooks.ts"),j=s("./packages/grafana-data/src/index.ts");function P(){const e=(0,S.UQ)(),{isLoading:a}=(0,S.ZV)(),s=(0,n.useTheme)();return a||0===e.length?null:(0,p.jsx)(n.InfoBox,{"aria-label":i.wl.pages.PluginsList.signatureErrorNotice,severity:"warning",urlTitle:"Read more about plugin signing",url:"https://grafana.com/docs/grafana/latest/plugins/plugin-signatures/",children:(0,p.jsxs)("div",{children:[m||(m=(0,p.jsx)("p",{children:"Unsigned plugins were found during plugin initialization. Grafana Labs cannot guarantee the integrity of these plugins. We recommend only using signed plugins."})),"The following plugins are disabled and not shown in the list below:",(0,p.jsx)(n.List,{items:e,className:d.css`
            list-style-type: circle;
          `,renderItem:e=>(0,p.jsx)("div",{className:d.css`
                margin-top: ${s.spacing.sm};
              `,children:(0,p.jsxs)(n.HorizontalGroup,{spacing:"sm",justify:"flex-start",align:"center",children:[(0,p.jsx)("strong",{children:e.pluginId}),(0,p.jsx)(n.PluginSignatureBadge,{status:v(e.errorCode),className:d.css`
                    margin-top: 0;
                  `})]})})})]})})}function v(e){switch(e){case j.PluginErrorCode.invalidSignature:return j.PluginSignatureStatus.invalid;case j.PluginErrorCode.missingSignature:return j.PluginSignatureStatus.missing;case j.PluginErrorCode.modifiedSignature:return j.PluginSignatureStatus.modified;default:return j.PluginSignatureStatus.missing}}function b(e,a,s){return a in e?Object.defineProperty(e,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[a]=s,e}const C={addDataSource:l.J_,loadDataSourcePlugins:l.Kj,setDataSourceTypeSearchQuery:u.Ht},_=(0,t.connect)((function(e){return{navModel:N(),plugins:(0,c.xo)(e.dataSources),searchQuery:e.dataSources.dataSourceTypeSearchQuery,categories:e.dataSources.categories,isLoading:e.dataSources.isLoadingDataSources}}),C);class k extends r.PureComponent{constructor(){super(...arguments),b(this,"onDataSourceTypeClicked",(e=>{this.props.addDataSource(e)})),b(this,"onSearchQueryChange",(e=>{this.props.setDataSourceTypeSearchQuery(e)})),b(this,"onLearnMoreClick",(e=>{e.stopPropagation()}))}componentDidMount(){this.props.loadDataSourcePlugins()}renderPlugins(e){return e&&e.length?(0,p.jsx)(n.List,{items:e,getItemKey:e=>e.id.toString(),renderItem:e=>(0,p.jsx)(D,{plugin:e,onClick:()=>this.onDataSourceTypeClicked(e),onLearnMoreClick:this.onLearnMoreClick})}):null}renderCategories(){const{categories:e}=this.props;return(0,p.jsxs)(p.Fragment,{children:[e.map((e=>(0,p.jsxs)("div",{className:"add-data-source-category",children:[(0,p.jsx)("div",{className:"add-data-source-category__header",children:e.title}),this.renderPlugins(e.plugins)]},e.id))),h||(h=(0,p.jsx)("div",{className:"add-data-source-more",children:(0,p.jsx)(n.LinkButton,{variant:"secondary",href:"https://grafana.com/plugins?type=datasource&utm_source=grafana_add_ds",target:"_blank",rel:"noopener",children:"Find more data source plugins on grafana.com"})}))]})}render(){const{navModel:e,isLoading:a,searchQuery:s,plugins:r}=this.props;return(0,p.jsx)(o.Z,{navModel:e,children:(0,p.jsxs)(o.Z.Contents,{isLoading:a,children:[(0,p.jsxs)("div",{className:"page-action-bar",children:[(0,p.jsx)(n.FilterInput,{value:s,onChange:this.onSearchQueryChange,placeholder:"Filter by name or type"}),f||(f=(0,p.jsx)("div",{className:"page-action-bar__spacer"})),x||(x=(0,p.jsx)(n.LinkButton,{href:"datasources",fill:"outline",variant:"secondary",icon:"arrow-left",children:"Cancel"}))]}),!s&&(y||(y=(0,p.jsx)(P,{}))),(0,p.jsxs)("div",{children:[s&&this.renderPlugins(r),!s&&this.renderCategories()]})]})})}}const D=e=>{var a,s;const{plugin:r,onLearnMoreClick:t}=e,o="phantom"===r.module,l=o||r.unlicensed?()=>{}:e.onClick,c=(null===(a=r.info)||void 0===a||null===(s=a.links)||void 0===s?void 0:s.length)>0?r.info.links[0]:null;return(0,p.jsx)(g,{title:r.name,description:r.info.description,ariaLabel:i.wl.pages.AddDataSource.dataSourcePlugins(r.name),logoUrl:r.info.logos.small,actions:(0,p.jsxs)(p.Fragment,{children:[c&&(0,p.jsx)(n.LinkButton,{variant:"secondary",href:`${c.url}?utm_source=grafana_add_ds`,target:"_blank",rel:"noopener",onClick:t,icon:"external-link-alt",children:c.name}),!o&&(0,p.jsx)(n.Button,{disabled:r.unlicensed,children:"Select"})]}),labels:!o&&(0,p.jsx)(n.PluginSignatureBadge,{status:r.signature}),className:o?"add-data-source-item--phantom":"",onClick:l,"aria-label":i.wl.pages.AddDataSource.dataSourcePlugins(r.name)})};function N(){const e={icon:"database",id:"datasource-new",text:"Add data source",href:"datasources/new",subTitle:"Choose a data source type"};return{main:e,node:e}}const L=_(k)},"./public/app/features/plugins/admin/state/hooks.ts":(e,a,s)=>{s.d(a,{iY:()=>z,bt:()=>N,ZV:()=>D,GE:()=>P,UQ:()=>b,bJ:()=>v,x3:()=>C,IS:()=>L,y9:()=>k,S1:()=>_,wq:()=>w});var r=s("./.yarn/cache/react-npm-17.0.1-98658812fc-83b9df9529.zip/node_modules/react/index.js"),t=s("./.yarn/__virtual__/react-redux-virtual-8e30c710ae/0/cache/react-redux-npm-7.2.5-cf7e365145-04ac4a4178.zip/node_modules/react-redux/es/index.js"),n=s("./public/app/features/plugins/admin/state/reducer.ts"),i=s("./public/app/features/plugins/admin/state/actions.ts"),o=s("./.yarn/cache/reselect-npm-4.1.0-69c7ae5e35-ef150c3ccc.zip/node_modules/reselect/es/index.js"),l=s("./public/app/features/plugins/admin/types.ts");const c=e=>e.plugins,u=(0,o.P1)(c,(e=>{let{items:a}=e;return a})),d=(0,o.P1)(c,(e=>{let{settings:a}=e;return a.displayMode})),{selectAll:p,selectById:g}=n.CD.getSelectors(u),m=(e,a)=>(0,o.P1)((e=>(0,o.P1)(p,(a=>a.filter((a=>"installed"===e?a.isInstalled:!a.isCore)))))(e),(e=>e.filter((e=>"all"===a||e.type===a)))),h=(e,a,s)=>(0,o.P1)(m(a,s),(e=>(0,o.P1)(p,(a=>""===e?[]:a.filter((a=>{const s=[];return a.name&&s.push(a.name.toLowerCase()),a.orgName&&s.push(a.orgName.toLowerCase()),s.some((a=>a.includes(e.toLowerCase())))})))))(e),((a,s)=>""===e?a:s)),f=(0,o.P1)(p,(e=>e?e.filter((e=>Boolean(e.error))).map((e=>({pluginId:e.id,errorCode:e.error}))):[])),x=e=>(0,o.P1)(c,(a=>{let{requests:s={}}=a;return s[e]})),y=e=>(0,o.P1)(x(e),(e=>(null==e?void 0:e.status)===l.eE.Pending)),S=e=>(0,o.P1)(x(e),(e=>(null==e?void 0:e.status)===l.eE.Rejected?null==e?void 0:e.error:null));var j=s("./public/app/features/plugins/admin/helpers.ts");const P=e=>{let{query:a="",filterBy:s="installed",filterByType:r="all",sortBy:n=j.Nh.nameAsc}=e;Q();const i=(0,t.useSelector)(h(a,s,r)),{isLoading:o,error:l}=D();return{isLoading:o,error:l,plugins:(0,j.AA)(i,n)}},v=e=>(Q(),T(e),(0,t.useSelector)((a=>g(a,e)))),b=()=>(Q(),(0,t.useSelector)(f)),C=()=>{const e=(0,t.useDispatch)();return(a,s,r)=>e((0,i.N9)({id:a,version:s,isUpdating:r}))},_=()=>{const e=(0,t.useDispatch)();return a=>e((0,i.Tz)(a))},k=()=>null===(0,t.useSelector)(S(i.tQ.typePrefix)),D=()=>({isLoading:(0,t.useSelector)(y(i.Qd.typePrefix)),error:(0,t.useSelector)(S(i.Qd.typePrefix))}),N=()=>({isLoading:(0,t.useSelector)(y(i.DD.typePrefix)),error:(0,t.useSelector)(S(i.DD.typePrefix))}),L=()=>({isInstalling:(0,t.useSelector)(y(i.N9.typePrefix)),error:(0,t.useSelector)(S(i.N9.typePrefix))}),w=()=>({isUninstalling:(0,t.useSelector)(y(i.Tz.typePrefix)),error:(0,t.useSelector)(S(i.Tz.typePrefix))}),Q=()=>{const e=(0,t.useDispatch)(),a=(0,t.useSelector)((s=i.Qd.typePrefix,(0,o.P1)(x(s),(e=>void 0===e))));var s;(0,r.useEffect)((()=>{a&&e((0,i.Qd)())}),[])},T=e=>{const a=(0,t.useDispatch)(),s=(0,t.useSelector)((a=>g(a,e))),n=!(0,t.useSelector)(y(i.DD.typePrefix))&&s&&!s.details;(0,r.useEffect)((()=>{n&&a((0,i.DD)(e))}),[s])},z=()=>{const e=(0,t.useDispatch)();return{displayMode:(0,t.useSelector)(d),setDisplayMode:a=>e((0,n.UC)(a))}}}}]);
//# sourceMappingURL=NewDataSourcePage.07a78e2e5dfa22b54847.js.map